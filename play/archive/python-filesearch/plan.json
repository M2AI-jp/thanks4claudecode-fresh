{
  "format_version": "2.0",
  "meta": {
    "id": "python-filesearch",
    "branch": "feat/python-filesearch",
    "created": "2026-01-06",
    "status": "active",
    "review_profile": "standard",
    "reviewed": true,
    "reviewed_by": "reviewer",
    "roles": {
      "orchestrator": "claudecode",
      "worker": "claudecode",
      "reviewer": "reviewer",
      "human": "user"
    }
  },
  "goal": {
    "summary": "Python CLI ツール dir_brief.py を tmp/ に作成し、指定パスの1階層一覧とサマリーを ASCII テーブルで表示する",
    "done_when": [
      "./tmp/dir_brief.py <path> で実行可能である",
      "1階層一覧（ファイル/ディレクトリ）が表示される",
      "件数合計が表示される",
      "最大サイズが表示される",
      "最新更新日時が表示される",
      "空ディレクトリでもサマリーが表示される",
      "出力が ASCII テーブル形式である",
      "pytest tmp/test_dir_brief.py が全 PASS である",
      "git push が完了している"
    ],
    "scope": {
      "includes": [
        "tmp/dir_brief.py の新規作成",
        "tmp/test_dir_brief.py の新規作成",
        "chmod +x による実行権限付与",
        "git push"
      ],
      "excludes": [
        "再帰的なディレクトリ走査（1階層のみ）",
        "外部ライブラリの使用",
        "GUI/TUI インターフェース"
      ]
    }
  },
  "context": {
    "analysis_result": {
      "source": "prompt-analyzer",
      "data": {
        "primary_topic_type": "instruction",
        "confidence": "high",
        "5w1h": {
          "who": "開発者（ユーザー自身）",
          "what": "Python CLI ツール dir_brief.py を tmp/ に新規作成 - 指定パスの1階層一覧表示、件数合計・最大サイズ・最新更新日時のサマリー出力、pytest テスト作成、git push まで実行",
          "when": "即時",
          "where": "tmp/dir_brief.py, tmp/test_dir_brief.py",
          "why": "手元のフォルダをざっと確認できる軽量ツールが欲しい",
          "how": "標準ライブラリのみ使用、ASCII テーブル形式出力、pytest でテスト、git push",
          "missing": []
        },
        "risks": {
          "technical": [
            {
              "risk": "ASCII テーブル描画を標準ライブラリのみで実装",
              "severity": "low",
              "mitigation": "手動でテーブル罫線を実装"
            }
          ],
          "scope": [
            {
              "risk": "1階層のみの解釈",
              "severity": "low",
              "mitigation": "明示的に指定されている"
            }
          ],
          "dependency": [
            {
              "risk": "git push 先は feat/python-filesearch",
              "severity": "medium",
              "mitigation": "ブランチ確認済み"
            }
          ]
        },
        "test_strategy": {
          "test_types": ["unit"],
          "coverage_target": "standard",
          "edge_cases": [
            "空ディレクトリでのサマリー表示（明示的に要求）",
            "存在しないパス指定時のエラーハンドリング"
          ]
        },
        "preconditions": {
          "existing_code": {
            "status": "新規作成",
            "files": [
              "tmp/dir_brief.py（新規）",
              "tmp/test_dir_brief.py（新規）"
            ]
          },
          "dependencies": {
            "installed": ["Python 3.x", "pytest"],
            "required": []
          },
          "constraints": {
            "technical": [
              "標準ライブラリのみ使用",
              "shebang: #!/usr/bin/env python3",
              "実行権限（chmod +x）が必要"
            ]
          }
        },
        "success_criteria": {
          "functional": [
            "./tmp/dir_brief.py <path> で実行可能",
            "1階層一覧（ファイル/ディレクトリ）を表示",
            "件数合計を表示",
            "最大サイズを表示",
            "最新更新日時を表示",
            "空ディレクトリでもサマリーを表示",
            "出力が ASCII テーブル形式",
            "pytest tmp/test_dir_brief.py が全 PASS",
            "git push が完了"
          ]
        }
      }
    },
    "user_approved_understanding": {
      "source": "auto_approve",
      "approved_at": "2026-01-06",
      "summary": "AUTO_APPROVED（auto_approve=true）",
      "approved_items": [
        "dir_brief.py を tmp/ に作成",
        "標準ライブラリのみ使用",
        "ASCII テーブル形式出力",
        "pytest テスト作成",
        "git push 実行"
      ],
      "technical_requirements_confirmed": [
        "shebang: #!/usr/bin/env python3",
        "chmod +x による実行権限",
        "空ディレクトリ対応"
      ]
    }
  },
  "max_iterations": 5,
  "phases": [
    {
      "id": "p1",
      "name": "CLI ツール実装",
      "description": "dir_brief.py を作成し、1階層一覧とサマリーを ASCII テーブルで表示する機能を実装する",
      "depends_on": [],
      "subtasks": [
        {
          "id": "p1.1",
          "criterion": "tmp/dir_brief.py が存在し、shebang が #!/usr/bin/env python3 である",
          "executor": "claudecode",
          "coding": true,
          "validation_plan": {
            "technical": "test -f tmp/dir_brief.py && head -1 tmp/dir_brief.py",
            "consistency": "Python 3 構文として valid である",
            "completeness": "shebang が正しく設定されている"
          }
        },
        {
          "id": "p1.2",
          "criterion": "tmp/dir_brief.py に実行権限が付与されている",
          "executor": "claudecode",
          "coding": false,
          "validation_plan": {
            "technical": "test -x tmp/dir_brief.py で終了コード 0",
            "consistency": "Unix 実行権限が設定されている",
            "completeness": "chmod +x が完了している"
          }
        },
        {
          "id": "p1.3",
          "criterion": "./tmp/dir_brief.py . が実行可能で、1階層一覧・件数合計・最大サイズ・最新更新日時が ASCII テーブルで表示される",
          "executor": "claudecode",
          "coding": true,
          "validation_plan": {
            "technical": "./tmp/dir_brief.py . を実行し出力を確認",
            "consistency": "ASCII テーブル罫線が使用されている",
            "completeness": "一覧、件数、最大サイズ、最新更新日時の4要素が全て表示される"
          }
        },
        {
          "id": "p1.4",
          "criterion": "./tmp/dir_brief.py を空ディレクトリに対して実行すると、サマリー（件数0、サイズ0、日時なし等）が表示される",
          "executor": "claudecode",
          "coding": true,
          "validation_plan": {
            "technical": "空の一時ディレクトリを作成し実行して出力確認",
            "consistency": "エラーではなくサマリーが表示される",
            "completeness": "件数0の場合も正常出力される"
          }
        }
      ]
    },
    {
      "id": "p2",
      "name": "テスト作成",
      "description": "pytest 用のテストファイルを作成し、エッジケースを含むテストを実装する",
      "depends_on": ["p1"],
      "subtasks": [
        {
          "id": "p2.1",
          "criterion": "tmp/test_dir_brief.py が存在し、pytest で実行可能な形式である",
          "executor": "claudecode",
          "coding": true,
          "validation_plan": {
            "technical": "test -f tmp/test_dir_brief.py で存在確認",
            "consistency": "pytest 形式（test_ プレフィックス）のテスト関数が定義されている",
            "completeness": "import 文とテスト関数が含まれている"
          }
        },
        {
          "id": "p2.2",
          "criterion": "pytest tmp/test_dir_brief.py が全 PASS で終了する",
          "executor": "claudecode",
          "coding": true,
          "validation_plan": {
            "technical": "pytest tmp/test_dir_brief.py を実行し終了コード 0",
            "consistency": "全テストケースが PASS",
            "completeness": "空ディレクトリ、存在しないパスのエッジケースが含まれている"
          }
        }
      ]
    },
    {
      "id": "p_final",
      "name": "最終検証",
      "description": "done_when の全項目を独立検証し、git push を実行する",
      "depends_on": ["p2"],
      "subtasks": [
        {
          "id": "p_final.1",
          "criterion": "reviewer が done_when の全項目を検証し PASS している",
          "executor": "reviewer",
          "coding": false,
          "validation_plan": {
            "technical": "各 done_when 項目に対してコマンド実行で検証",
            "consistency": "全項目が一貫して満たされている",
            "completeness": "9個の done_when 項目が全て PASS"
          }
        }
      ]
    }
  ],
  "final_tasks": [
    {
      "id": "ft1",
      "description": "git push を実行する",
      "command": "git push -u origin feat/python-filesearch",
      "auto": true
    }
  ]
}
