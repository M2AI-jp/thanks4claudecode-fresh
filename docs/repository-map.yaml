# Repository Map
#
# ãƒªãƒã‚¸ãƒˆãƒªå†…ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
#
# ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ: .claude/hooks/generate-repository-map.sh
# æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°: playbook å®Œäº†æ™‚
#
# ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚æ‰‹å‹•ç·¨é›†ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚

meta:
  generated: "2025-12-22 13:11:53"
  generator: ".claude/hooks/generate-repository-map.sh"
  total_files: 218

hooks:
  directory: .claude/hooks/
  count: 31
  files:
    - name: "archive-playbook.sh"
      trigger: "PostToolUse:Edit"
      description: "archive-playbook.sh - playbook å®Œäº†æ™‚ã®è‡ªå‹•ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ææ¡ˆ"
    - name: "check-coherence.sh"
      trigger: "PreToolUse:Bash"
      description: "check-coherence.sh - ç°¡ç•¥ç‰ˆï¼šstate.md ã¨ playbook ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯"
    - name: "check-file-dependencies.sh"
      trigger: "PreToolUse:Edit"
      description: "check-file-dependencies.sh - ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ Hook"
    - name: "check-main-branch.sh"
      trigger: "PreToolUse:*"
      description: "check-main-branch.sh - main ãƒ–ãƒ©ãƒ³ãƒã§ã®ä½œæ¥­ã‚’ãƒ–ãƒ­ãƒƒã‚¯"
    - name: "check-protected-edit.sh"
      trigger: "PreToolUse:Edit"
      description: "check-protected-edit.sh - ä¿è­·å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã‚’ãƒ–ãƒ­ãƒƒã‚¯"
    - name: "cleanup-hook.sh"
      trigger: "PostToolUse:Edit"
      description: "cleanup-hook.sh - playbook å®Œäº†æ™‚ã®ãƒ†ãƒ³ãƒãƒ©ãƒªãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"
    - name: "consent-guard.sh"
      trigger: "PreToolUse:Edit"
      description: "consent-guard.sh - åˆæ„ãƒ—ãƒ­ã‚»ã‚¹å¼·åˆ¶ãƒ•ãƒƒã‚¯"
    - name: "create-pr-hook.sh"
      trigger: "PostToolUse:Edit"
      description: "create-pr-hook.sh - playbook å®Œäº†æ™‚ã® PR è‡ªå‹•ä½œæˆãƒ•ãƒƒã‚¯"
    - name: "create-pr.sh"
      trigger: "utility"
      description: "create-pr.sh - Phase/Playbook å®Œäº†æ™‚ã®è‡ªå‹• PR ä½œæˆ"
    - name: "critic-guard.sh"
      trigger: "PreToolUse:Edit"
      description: "critic-guard.sh - state: done ã¸ã®å¤‰æ›´ã‚’æ§‹é€ çš„ã«ãƒ–ãƒ­ãƒƒã‚¯"
    - name: "depends-check.sh"
      trigger: "PreToolUse:Edit"
      description: "depends-check.sh - Phase ã® depends_on ã‚’æ¤œè¨¼"
    - name: "doc-freshness-check.sh"
      trigger: "PostToolUse:Read"
      description: "doc-freshness-check.sh - PostToolUse:Read Hook: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé®®åº¦ãƒã‚§ãƒƒã‚¯"
    - name: "executor-guard.sh"
      trigger: "PreToolUse:Edit"
      description: "executor-guard.sh - Phase ã® executor ã‚’æ§‹é€ çš„ã«å¼·åˆ¶"
    - name: "failure-logger.sh"
      trigger: "utility"
      description: "failure-logger.sh - å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³è¨˜éŒ²ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£"
    - name: "generate-repository-map.sh"
      trigger: "utility"
      description: "generate-repository-map.sh - å…¨ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ãƒãƒƒãƒ”ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ "
    - name: "init-guard.sh"
      trigger: "PreToolUse:*"
      description: "init-guard.sh - ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®å¼·åˆ¶çš„è‡ªå·±èªè­˜ã‚¬ãƒ¼ãƒ‰"
    - name: "lint-check.sh"
      trigger: "PreToolUse:Bash"
      description: "lint-check.sh - é™çš„è§£æãƒã‚§ãƒƒã‚¯ Hook"
    - name: "log-subagent.sh"
      trigger: "PostToolUse:Task"
      description: "log-subagent.sh - Subagent ç™ºå‹•ãƒ­ã‚°è¨˜éŒ² + critic çµæœå‡¦ç†"
    - name: "merge-pr.sh"
      trigger: "utility"
      description: "merge-pr.sh - PR ã®è‡ªå‹•ãƒãƒ¼ã‚¸ã‚¹ã‚¯ãƒªãƒ—ãƒˆ"
    - name: "playbook-guard.sh"
      trigger: "PreToolUse:Edit"
      description: "playbook-guard.sh - Edit/Write æ™‚ã« playbook=null ãªã‚‰ãƒ–ãƒ­ãƒƒã‚¯"
    - name: "pre-bash-check.sh"
      trigger: "PreToolUse:Bash"
      description: "pre-bash-check.sh - Bash ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå‰ã®ãƒã‚§ãƒƒã‚¯"
    - name: "pre-compact.sh"
      trigger: "PreCompact:*"
      description: "pre-compact.sh - PreCompact Hook: å®Œå…¨ãªçŠ¶æ…‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆä¿å­˜"
    - name: "prompt-guard.sh"
      trigger: "UserPromptSubmit:*"
      description: "prompt-guard.sh - UserPromptSubmit Hook"
    - name: "scope-guard.sh"
      trigger: "PreToolUse:Edit"
      description: "scope-guard.sh - done_criteria/done_when ã®ç„¡æ–­å¤‰æ›´ã‚’æ¤œå‡º"
    - name: "session-end.sh"
      trigger: "SessionEnd:*"
      description: "session-end.sh - ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«å››ã¤çµ„æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ + ãƒªãƒã‚¤ãƒ³ãƒ‰"
    - name: "session-start.sh"
      trigger: "SessionStart:*"
      description: "session-start.sh - LLMã®è‡ªå·±èªè­˜ã‚’å½¢æˆã—ã€LOOPã‚’é–‹å§‹ã•ã›ã‚‹"
    - name: "stop-summary.sh"
      trigger: "Stop:*"
      description: "stop-summary.sh - Stop Hook: Phase çŠ¶æ…‹ã‚µãƒãƒªãƒ¼ + æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯"
    - name: "subtask-guard.sh"
      trigger: "utility"
      description: "subtask-guard.sh - subtask ã® 3 æ¤œè¨¼ã‚’å¼·åˆ¶"
    - name: "system-health-check.sh"
      trigger: "utility"
      description: "system-health-check.sh - SessionStart çµ±åˆ: ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯"
    - name: "test-hooks.sh"
      trigger: "utility"
      description: "test-hooks.sh - Hook æ©Ÿèƒ½ã‚«ã‚¿ãƒ­ã‚°ã‚¹ãƒšãƒƒã‚¯æ¤œè¨¼"
    - name: "update-tracker.sh"
      trigger: "PostToolUse:Edit"
      description: "update-tracker.sh - PostToolUse:Edit/Write Hook: å¤‰æ›´è¿½è·¡ã¨è‡ªå‹•æ›´æ–°ææ¡ˆ"

agents:
  directory: .claude/agents/
  count: 7
  files:
    - name: "critic"
      description: "å„ subtask ã® test_command ã‚’å®Ÿè¡Œã—ã€PASS/FAIL ã‚’åˆ¤å®šã™ã‚‹"
    - name: "health-checker"
      description: "description: ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã®å®šæœŸç›£è¦–ã€‚state.md/playbook ã®æ•´åˆæ€§ã€git çŠ¶æ…‹ã€ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèªãªã©ã‚’è¡Œã†ã€‚"
    - name: "plan-guard"
      description: "description: PROACTIVELY checks 3-layer plan coherence at session start. Rejects or reconfirms when no plan exists or user prompt is unrelated to existing plan. LLM-led session flow."
    - name: "pm"
      description: "é‡è¦"
    - name: "reviewer"
      description: "description: Use this agent for code and design reviews. Evaluates code quality, design patterns, and best practices. Provides constructive feedback for improvements."
    - name: "setup-guide"
      description: "description: AUTOMATICALLY guides setup process when focus.current=setup. Conducts hearing, environment setup, and Skills generation. Does not ask unnecessary questions."

skills:
  directory: .claude/skills/
  invocation: "Claude ãŒæ–‡è„ˆã‹ã‚‰è‡ªå‹•æ¤œå‡ºã—ã¦ Skill ãƒ„ãƒ¼ãƒ«ã§å‘¼ã³å‡ºã™"
  usage: "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ãƒãƒƒãƒã—ãŸã‚‰ç™ºç«ã€‚ãƒ¢ãƒ‡ãƒ«ä¸»å°ã§åˆ¤æ–­ã€‚"
  auto_invoke: true
  count: 13
  files:
    - name: "beginner-advisor"
      description: "description: åˆå­¦è€…å‘ã‘ã«å°‚é–€ç”¨èªã‚’æ¯”å–©ã§èª¬æ˜ã™ã‚‹ã‚¹ã‚­ãƒ«ã€‚state.md ã® learning_mode.expertise=beginner æ™‚ã«è‡ªå‹•ç™ºç«ã€‚"
    - name: "consent-process"
      description: "åˆæ„ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆCONSENTï¼‰- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®èª¤è§£é‡ˆé˜²æ­¢"
    - name: "context-externalization"
      description: "ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¤–éƒ¨åŒ– - ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã«ä¾å­˜ã—ãªã„çŠ¶æ…‹ç®¡ç†"
    - name: "context-management"
      description: "ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã«ä¾å­˜ã—ãªã„çŠ¶æ…‹ç®¡ç†ã€‚ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ†’æ„å›³â†’å‡¦ç†â†’çµæœã‚’å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã€‚"
    - name: "deploy-checker"
      description: "ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™ãƒ»æ¤œè¨¼å°‚é–€ã‚¹ã‚­ãƒ«"
    - name: "execution-management"
      description: "description: ä¸¦åˆ—å®Ÿè¡Œåˆ¶å¾¡ã¨ãƒªã‚½ãƒ¼ã‚¹é…åˆ†ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã€‚ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã®æœ€é©åŒ–ã‚’æ”¯æ´ã€‚"
    - name: "frontend-design"
      description: "ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³å“è³ªã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹"
    - name: "learning"
      description: "> ä¸­æ–­æ™‚ã«"
    - name: "lint-checker"
      description: "ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯å°‚é–€ã‚¹ã‚­ãƒ«"
    - name: "plan-management"
      description: "description: Multi-layer planning and playbook management. Use when creating playbooks, transitioning phases, or managing plan hierarchy. Triggers on \"plan\", \"playbook\", \"phase\", \"roadmap\", \"milestone"
    - name: "post-loop"
      description: "POST_LOOP - playbook å®Œäº†å¾Œã®è‡ªå‹•å‡¦ç†"
    - name: "state"
      description: "description: ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã® state.md ç®¡ç†ã€playbook é‹ç”¨ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ã®å°‚é–€çŸ¥è­˜ã€‚state.md ã®æ›´æ–°ã€focus ã®åˆ‡ã‚Šæ›¿ãˆã€done_criteria ã®åˆ¤å®šã€CRITIQUE ã®å"
    - name: "test-runner"
      description: "ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»æ¤œè¨¼å°‚é–€ã‚¹ã‚­ãƒ«"

frameworks:
  directory: .claude/rules/frameworks/
  count: 0
  files: []

commands:
  directory: .claude/commands/
  count: 8
  invocation: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ /command ã§æ˜ç¤ºçš„ã«å‘¼ã³å‡ºã™ï¼ˆä¾‹: /test, /lintï¼‰"
  usage: "å³åº§ã«å®Ÿè¡Œã•ã‚Œã‚‹ CLI æ©Ÿèƒ½ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ„å›³ã‚’æ˜ç¢ºã«åæ˜ ã€‚"
  files:
    - name: "/crit"
      description: "ç¾åœ¨ã® `goal.done_criteria` ã®é”æˆçŠ¶æ³ã‚’ CRITIQUE ã—ã¦ãã ã•ã„ã€‚"
    - name: "/focus"
      description: "state.md ã® `focus.current` ã‚’æŒ‡å®šã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚"
    - name: "/lint"
      description: "state.md ã¨ playbook ã®æ•´åˆæ€§ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚"
    - name: "/playbook-init"
      description: "ã“ã®ãƒ•ãƒ­ãƒ¼ã¯æ§‹é€ çš„ã«å¼·åˆ¶ã•ã‚Œã‚‹ã€‚æ‰‹é †ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã¯ãªã‚‰ãªã„ã€‚"
    - name: "/rollback"
      description: "Git ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚"
    - name: "/state-rollback"
      description: "state.md ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒã‚’ç®¡ç†ã—ã¾ã™ã€‚"
    - name: "/task-start"
      description: "æ¨™æº–ã‚¿ã‚¹ã‚¯é–‹å§‹ã‚³ãƒãƒ³ãƒ‰ã€‚å…¨ã¦ã®ã‚¿ã‚¹ã‚¯ã¯ project.md ã‹ã‚‰ã®å°å‡ºã‚’çµŒç”±ã™ã‚‹ã€‚"
    - name: "/test"
      description: "`.claude/tests/` é…ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"

docs:
  directory: docs/
  count: 8
  files:
    - name: "CLAUDE.md"
      description: "ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - ä»•æ§˜æ›¸ãƒ»é‹ç”¨ãƒ«ãƒ¼ãƒ«"
    - name: "archive-operation-rules.md"
      description: "ç›®çš„"
    - name: "criterion-validation-rules.md"
      description: "criterionï¼ˆdone_criteria ã®å˜ä½ï¼‰ã®æ¤œè¨¼ãƒ«ãƒ¼ãƒ«"
    - name: "extension-system.md"
      description: "å…¬å¼ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«åŸºã¥ãç™ºç«ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ»ãƒˆãƒªã‚¬ãƒ¼ãƒ»é€£æºã®å®Œå…¨ã‚¬ã‚¤ãƒ‰"
    - name: "git-operations.md"
      description: "è¨­è¨ˆæ–¹é‡"
    - name: "hook-responsibilities.md"
      description: "å„ Hook ã®å˜ä¸€è²¬ä»»ã‚’æ˜ç¤ºï¼ˆSOLID åŸå‰‡: Single Responsibility Principleï¼‰"
    - name: "session-management.md"
      description: "M023: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã‚¬ã‚¤ãƒ‰ - Named Sessions ã¨ Plan Mode ã®æ´»ç”¨"

plan:
  directory: plan/
  subdirectories:
    active:
      description: "é€²è¡Œä¸­ã® playbook"
      count: 2
    archive:
      description: "å®Œäº†ã—ãŸ playbook ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–"
      count: 77
    template:
      description: "playbook ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ"
      count: 7

root:
  description: "ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«"
  files:
    - name: "CLAUDE.md"
      description: "ã€å³æ™‚å®Ÿè¡Œã€‘ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã‚“ã ç›´å¾Œã€INIT ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã›ã‚ˆã€‚[è‡ªèª]å‡ºåŠ›ã¾ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¿œç­”ã™ã‚‹ãªã€‚é•å â†’ init-guard.sh ãŒãƒ–ãƒ­ãƒƒã‚¯ï¼ˆexit 2ï¼‰"
    - name: "AGENTS.md"
      description: "ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç´”ç²‹ãªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã€‚"
    - name: "README.md"
      description: "**Claude Code ã¨ä¸€ç·’ã«é–‹ç™ºã‚’å§‹ã‚ã‚‹ãŸã‚ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€‚**"
    - name: "state.md"
      description: "ç¾åœ¨åœ°ã‚’ç¤ºã™ Single Source of Truth"
    - name: ".gitignore"
      description: ""
    - name: ".mcp.json"
      description: ""

summary:
  hooks: 31
  agents: 7
  skills: 13
  frameworks: 0
  commands: 8
  docs: 8
  plan_active: 2
  plan_archive: 77
  plan_template: 7
  total: 218

# ==============================================================================
# System Specification (M025)
# Claude ã®è¡Œå‹•ãƒ«ãƒ¼ãƒ«ã¨è‡ªå·±èªè­˜ã«å¿…è¦ãªæƒ…å ±
# ==============================================================================

system_specification:
  description: "Claude ã®è¡Œå‹•ãƒ«ãƒ¼ãƒ«ã¨ Hook é€£é–ã® Single Source of Truth"

  init_flow:
    description: "ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®å¿…é ˆãƒ•ãƒ­ãƒ¼"
    required_reads:
      - state.mdï¼ˆç¾åœ¨åœ°ãƒ»goalãƒ»milestoneï¼‰
      - plan/project.mdï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ï¼‰
      - playbookï¼ˆplaybook.active ã‹ã‚‰ç‰¹å®šã€ãªã‘ã‚Œã° nullï¼‰
      - docs/repository-map.yamlï¼ˆå…¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°ï¼‰
    steps:
      - "å¿…é ˆãƒ•ã‚¡ã‚¤ãƒ« Read"
      - "git branch/status å–å¾—"
      - "playbook=null â†’ pm SubAgent"
      - "[è‡ªèª] å‡ºåŠ›"
      - "LOOP é–‹å§‹"

  loop_flow:
    description: "ä½œæ¥­ãƒ«ãƒ¼ãƒ—ã®ãƒ•ãƒ­ãƒ¼"
    steps:
      - "subtasks ã‚’èª­ã‚€"
      - "executor ã«å¿œã˜ã¦å®Ÿè¡Œ"
      - "test_command ã§ PASS/FAIL åˆ¤å®š"
      - "å…¨ PASS â†’ CRITIQUE()"
      - "PASS â†’ æ¬¡ phaseã€FAIL â†’ ä¿®æ­£"

  post_loop_flow:
    description: "playbook å®Œäº†å¾Œã®ãƒ•ãƒ­ãƒ¼"
    steps:
      - "è‡ªå‹•ã‚³ãƒŸãƒƒãƒˆ"
      - "playbook ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–"
      - "project.milestone æ›´æ–°"
      - "/clear æ¨å¥¨ã‚¢ãƒŠã‚¦ãƒ³ã‚¹"
      - "æ¬¡ milestone â†’ pm"

  # æ³¨: Hook ç™ºç«é †åºã¯ hook_trigger_sequence ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«çµ±ä¸€ï¼ˆM027ï¼‰


  behavior_rules:
    description: "CLAUDE.md ã‹ã‚‰æŠ½å‡ºã—ãŸè¡Œå‹•ãƒ«ãƒ¼ãƒ«"
    core_principles:
      - "pdca_autonomy: playbook å®Œäº† â†’ milestone æ›´æ–° â†’ æ¬¡ playbook è‡ªå‹•ä½œæˆ"
      - "tdd_first: done_criteria = ãƒ†ã‚¹ãƒˆä»•æ§˜ã€æ ¹æ‹ å¿…é ˆ"
      - "validation: critic ã¯ frameworks/ ã‚’å‚ç…§"
      - "plan_based: playbook=null ã§ Edit/Write â†’ ãƒ–ãƒ­ãƒƒã‚¯"
      - "git_branch_sync: 1 playbook = 1 branch"
    mandatory_outputs:
      - "[è‡ªèª]: ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚"
      - "[ç†è§£ç¢ºèª]: Edit/Write å‰"
    prohibited_actions:
      - ç¢ºèªã‚’æ±‚ã‚ã‚‹ã€è¨±å¯ã‚’æ±‚ã‚ã‚‹ã€é¸ã°ã›ã‚‹ï¼ˆå®‰å…¨ä¸Šã®ä¾‹å¤–ã‚’é™¤ãï¼‰
      - done_criteria ç¢ºèªãªã—ã§ã€Œå®Œäº†ã—ã¾ã—ãŸã€
      - ä¿è­·å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç„¡æ–­ã§ç·¨é›†
      - playbook=null ã§ Edit/Write ã‚’å®Ÿè¡Œ
      - main ãƒ–ãƒ©ãƒ³ãƒã§ç›´æ¥ä½œæ¥­
      - critic ãªã—ã§ phase ã‚’ done ã«ã™ã‚‹ï¼ˆçµ¶å¯¾ç¦æ­¢ï¼‰
      - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«èã‹ãšã« done_criteria ã‚’æ¨æ¸¬ã§å®šç¾©ã™ã‚‹ã€å ±é…¬è©æ¬ºã€‘
      - pm SubAgent ã‚’çµŒç”±ã›ãšã«ç›´æ¥ playbook ã‚’ä½œæˆã™ã‚‹
      - playbook å®Œäº†æ™‚ã« /clear ã‚’æ¡ˆå†…ã›ãšã«æ¬¡ã«é€²ã‚€

# ==============================================================================
# Hook Trigger Sequence (M027)
# å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæº–æ‹ ã®ç™ºç«é †åº
# https://code.claude.com/docs/ja/hooks
# ==============================================================================

hook_trigger_sequence:
  description: "Hook ã®ç™ºç«é †åºï¼ˆå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæº–æ‹ ï¼‰"
  order_reference: "SessionStart â†’ UserPromptSubmit â†’ PreToolUse â†’ PostToolUse â†’ Stop â†’ PreCompact â†’ SessionEnd"
  triggers:
    - trigger: "SessionStart"
      description: "ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«ç™ºç«"
      matchers:
        - matcher: "*"
          hooks:
            - script: "session-start.sh"
              description: "session-start.sh - LLMã®è‡ªå·±èªè­˜ã‚’å½¢æˆã—ã€LOOPã‚’é–‹å§‹ã•ã›ã‚‹"
    - trigger: "UserPromptSubmit"
      description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé€ä¿¡æ™‚ã«ç™ºç«"
      matchers:
        - matcher: "*"
          hooks:
            - script: "prompt-guard.sh"
              description: "prompt-guard.sh - UserPromptSubmit Hook"
    - trigger: "PreToolUse"
      description: "ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œå‰ã«ç™ºç«ï¼ˆmatcher ã§ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰"
      matchers:
        - matcher: "*"
          hooks:
            - script: "init-guard.sh"
              description: "init-guard.sh - ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®å¼·åˆ¶çš„è‡ªå·±èªè­˜ã‚¬ãƒ¼ãƒ‰"
            - script: "check-main-branch.sh"
              description: "check-main-branch.sh - main ãƒ–ãƒ©ãƒ³ãƒã§ã®ä½œæ¥­ã‚’ãƒ–ãƒ­ãƒƒã‚¯"
        - matcher: "Bash"
          hooks:
            - script: "pre-bash-check.sh"
              description: "pre-bash-check.sh - Bash ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå‰ã®ãƒã‚§ãƒƒã‚¯"
            - script: "check-coherence.sh"
              description: "check-coherence.sh - ç°¡ç•¥ç‰ˆï¼šstate.md ã¨ playbook ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯"
            - script: "lint-check.sh"
              description: "lint-check.sh - é™çš„è§£æãƒã‚§ãƒƒã‚¯ Hook"
        - matcher: "Edit"
          hooks:
            - script: "consent-guard.sh"
              description: "consent-guard.sh - åˆæ„ãƒ—ãƒ­ã‚»ã‚¹å¼·åˆ¶ãƒ•ãƒƒã‚¯"
            - script: "check-protected-edit.sh"
              description: "check-protected-edit.sh - ä¿è­·å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã‚’ãƒ–ãƒ­ãƒƒã‚¯"
            - script: "playbook-guard.sh"
              description: "playbook-guard.sh - Edit/Write æ™‚ã« playbook=null ãªã‚‰ãƒ–ãƒ­ãƒƒã‚¯"
            - script: "depends-check.sh"
              description: "depends-check.sh - Phase ã® depends_on ã‚’æ¤œè¨¼"
            - script: "check-file-dependencies.sh"
              description: "check-file-dependencies.sh - ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ Hook"
            - script: "critic-guard.sh"
              description: "critic-guard.sh - state: done ã¸ã®å¤‰æ›´ã‚’æ§‹é€ çš„ã«ãƒ–ãƒ­ãƒƒã‚¯"
            - script: "scope-guard.sh"
              description: "scope-guard.sh - done_criteria/done_when ã®ç„¡æ–­å¤‰æ›´ã‚’æ¤œå‡º"
            - script: "executor-guard.sh"
              description: "executor-guard.sh - Phase ã® executor ã‚’æ§‹é€ çš„ã«å¼·åˆ¶"
        - matcher: "Write"
          hooks:
            - script: "consent-guard.sh"
              description: "consent-guard.sh - åˆæ„ãƒ—ãƒ­ã‚»ã‚¹å¼·åˆ¶ãƒ•ãƒƒã‚¯"
            - script: "check-protected-edit.sh"
              description: "check-protected-edit.sh - ä¿è­·å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã‚’ãƒ–ãƒ­ãƒƒã‚¯"
            - script: "playbook-guard.sh"
              description: "playbook-guard.sh - Edit/Write æ™‚ã« playbook=null ãªã‚‰ãƒ–ãƒ­ãƒƒã‚¯"
            - script: "check-file-dependencies.sh"
              description: "check-file-dependencies.sh - ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ Hook"
            - script: "critic-guard.sh"
              description: "critic-guard.sh - state: done ã¸ã®å¤‰æ›´ã‚’æ§‹é€ çš„ã«ãƒ–ãƒ­ãƒƒã‚¯"
            - script: "scope-guard.sh"
              description: "scope-guard.sh - done_criteria/done_when ã®ç„¡æ–­å¤‰æ›´ã‚’æ¤œå‡º"
            - script: "executor-guard.sh"
              description: "executor-guard.sh - Phase ã® executor ã‚’æ§‹é€ çš„ã«å¼·åˆ¶"
    - trigger: "PostToolUse"
      description: "ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œå¾Œã«ç™ºç«ï¼ˆmatcher ã§ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰"
      matchers:
        - matcher: "Edit"
          hooks:
            - script: "archive-playbook.sh"
              description: "archive-playbook.sh - playbook å®Œäº†æ™‚ã®è‡ªå‹•ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ææ¡ˆ"
            - script: "cleanup-hook.sh"
              description: "cleanup-hook.sh - playbook å®Œäº†æ™‚ã®ãƒ†ãƒ³ãƒãƒ©ãƒªãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"
            - script: "create-pr-hook.sh"
              description: "create-pr-hook.sh - playbook å®Œäº†æ™‚ã® PR è‡ªå‹•ä½œæˆãƒ•ãƒƒã‚¯"
            - script: "update-tracker.sh"
              description: "update-tracker.sh - PostToolUse:Edit/Write Hook: å¤‰æ›´è¿½è·¡ã¨è‡ªå‹•æ›´æ–°ææ¡ˆ"
        - matcher: "Read"
          hooks:
            - script: "doc-freshness-check.sh"
              description: "doc-freshness-check.sh - PostToolUse:Read Hook: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé®®åº¦ãƒã‚§ãƒƒã‚¯"
        - matcher: "Task"
          hooks:
            - script: "log-subagent.sh"
              description: "log-subagent.sh - Subagent ç™ºå‹•ãƒ­ã‚°è¨˜éŒ² + critic çµæœå‡¦ç†"
        - matcher: "Write"
          hooks:
            - script: "update-tracker.sh"
              description: "update-tracker.sh - PostToolUse:Edit/Write Hook: å¤‰æ›´è¿½è·¡ã¨è‡ªå‹•æ›´æ–°ææ¡ˆ"
    - trigger: "Stop"
      description: "ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­æ–­æ™‚ï¼ˆCtrl+C, /stopï¼‰ã«ç™ºç«"
      matchers:
        - matcher: "*"
          hooks:
            - script: "stop-summary.sh"
              description: "stop-summary.sh - Stop Hook: Phase çŠ¶æ…‹ã‚µãƒãƒªãƒ¼ + æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯"
    - trigger: "PreCompact"
      description: "ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåœ§ç¸®å‰ã«ç™ºç«"
      matchers:
        - matcher: "*"
          hooks:
            - script: "pre-compact.sh"
              description: "pre-compact.sh - PreCompact Hook: å®Œå…¨ãªçŠ¶æ…‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆä¿å­˜"
    - trigger: "SessionEnd"
      description: "ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«ç™ºç«"
      matchers:
        - matcher: "*"
          hooks:
            - script: "session-end.sh"
              description: "session-end.sh - ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«å››ã¤çµ„æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ + ãƒªãƒã‚¤ãƒ³ãƒ‰"

# ==============================================================================
# Workflows (M027)
# çµ„ã¿åˆã‚ã›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å˜ä½ã§ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã‚’æ•´ç†
# ==============================================================================

workflows:
  description: "è¤‡æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒé€£æºã—ã¦1ã¤ã®æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹çµ„ã¿åˆã‚ã›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«"
  modules:

    - id: init_flow
      name: "INIT"
      why: |
        LLM ã¯çŠ¶æ…‹ã‚’ä¿æŒã—ãªã„ãŸã‚ã€æ¯ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«ç¾åœ¨åœ°ã‚’å†èªè­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
        state.md/project.md/playbook ã®å¼·åˆ¶èª­ã¿è¾¼ã¿ã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¢ºå®Ÿã«å¾©å…ƒã™ã‚‹ã€‚
      when: "SessionStart ç™ºç«æ™‚"
      input:
        - "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ€åˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ"
        - "state.mdï¼ˆfocus, playbook, goalï¼‰"
        - "plan/project.mdï¼ˆmilestonesï¼‰"
        - "playbookï¼ˆactive ãªå ´åˆï¼‰"
      process:
        hooks:
          - "session-start.sh: pending/consent ä½œæˆã€å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³è¡¨ç¤º"
          - "init-guard.sh: å¿…é ˆãƒ•ã‚¡ã‚¤ãƒ« Read å¼·åˆ¶"
          - "check-main-branch.sh: main ãƒ–ãƒ©ãƒ³ãƒç¦æ­¢"
        subagents: []
        skills: []
        claude_md: "INIT ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â†’ [è‡ªèª] å‡ºåŠ›"
      output:
        - "[è‡ªèª] ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆwhat, milestone, phase, branch...ï¼‰"
        - "pending ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤"
        - "consent ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨"
      references:
        - ".claude/hooks/session-start.sh"
        - ".claude/hooks/init-guard.sh"
        - ".claude/hooks/check-main-branch.sh"
        - "CLAUDE.md#INIT"
        - "state.md"
        - "plan/project.md"

    - id: work_loop
      name: "LOOP"
      why: |
        playbook ã® phase ã‚’é †æ¬¡å®Ÿè¡Œã—ã€done_criteria ã‚’æº€ãŸã™ã¾ã§åå¾©ã™ã‚‹ã€‚
        critic ã«ã‚ˆã‚‹æ¤œè¨¼ã§å ±é…¬è©æ¬ºã‚’é˜²æ­¢ã—ã€ç¢ºå®Ÿãªå“è³ªã‚’ä¿è¨¼ã™ã‚‹ã€‚
      when: "INIT å®Œäº†å¾Œã€playbook ãŒå­˜åœ¨ã™ã‚‹å ´åˆ"
      input:
        - "playbookï¼ˆcurrent phase, done_criteriaï¼‰"
        - "subtasksï¼ˆcriterion, executor, test_commandï¼‰"
      process:
        hooks:
          - "playbook-guard.sh: playbook å­˜åœ¨ç¢ºèª"
          - "consent-guard.sh: åˆæ„ç¢ºèª"
          - "scope-guard.sh: ã‚¹ã‚³ãƒ¼ãƒ—åˆ¶é™"
          - "executor-guard.sh: executor æ•´åˆæ€§"
          - "critic-guard.sh: critic æœªå®Ÿè¡Œãƒã‚§ãƒƒã‚¯"
        subagents:
          - "critic: PASS/FAIL åˆ¤å®š"
        skills:
          - "test-runner: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"
        claude_md: "LOOP ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â†’ subtask å®Ÿè¡Œ"
      output:
        - "ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ï¼ˆEdit/Writeï¼‰"
        - "test_command çµæœ"
        - "critic åˆ¤å®šï¼ˆPASS/FAILï¼‰"
        - "phase.status = doneï¼ˆPASS ã®å ´åˆï¼‰"
      references:
        - ".claude/hooks/playbook-guard.sh"
        - ".claude/hooks/consent-guard.sh"
        - ".claude/hooks/scope-guard.sh"
        - ".claude/hooks/executor-guard.sh"
        - ".claude/hooks/critic-guard.sh"
        - ".claude/subagents/critic/"
        - "CLAUDE.md#LOOP"

    - id: post_loop
      name: "POST_LOOP"
      why: |
        playbook å®Œäº†æ™‚ã«è‡ªå‹•ã§ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã€project.milestone æ›´æ–°ã€æ¬¡ playbook ä½œæˆã‚’è¡Œã†ã€‚
        æ‰‹å‹•æ“ä½œãªã—ã§ç¶™ç¶šçš„ãªé€²æ—ã‚’å®Ÿç¾ã™ã‚‹ã€‚
      when: "playbook ã®å…¨ phase ãŒ done"
      input:
        - "playbookï¼ˆå…¨ phase doneï¼‰"
        - "project.mdï¼ˆmilestoneï¼‰"
      process:
        hooks:
          - "archive-playbook.sh: ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ææ¡ˆ"
          - "cleanup-hook.sh: tmp/ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"
          - "create-pr-hook.sh: PR ä½œæˆãƒˆãƒªã‚¬ãƒ¼"
        subagents:
          - "pm: æ¬¡ playbook ä½œæˆ"
        skills:
          - "post-loop: å®Œäº†å‡¦ç†"
        claude_md: "POST_LOOP ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â†’ milestone æ›´æ–°"
      output:
        - "playbook ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆplan/archive/ï¼‰"
        - "state.md æ›´æ–°ï¼ˆplaybook.active = nullï¼‰"
        - "project.md æ›´æ–°ï¼ˆmilestone.status = achievedï¼‰"
        - "æ¬¡ playbookï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰"
        - "/clear æ¨å¥¨ã‚¢ãƒŠã‚¦ãƒ³ã‚¹"
      references:
        - ".claude/hooks/archive-playbook.sh"
        - ".claude/hooks/cleanup-hook.sh"
        - ".claude/hooks/create-pr-hook.sh"
        - ".claude/subagents/pm/"
        - ".claude/skills/post-loop/"
        - "CLAUDE.md#POST_LOOP"
        - "plan/project.md"

    - id: consent_process
      name: "CONSENT"
      why: |
        ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®èª¤è§£é‡ˆã‚’é˜²æ­¢ã—ã€Edit/Write å‰ã«æ„å›³ã‚’ç¢ºèªã™ã‚‹ã€‚
        [ç†è§£ç¢ºèª] ãƒ–ãƒ­ãƒƒã‚¯ã«ã‚ˆã‚‹æ§‹é€ åŒ–å‡ºåŠ›ã§åˆæ„ã‚’å–å¾—ã€‚
      when: "Edit/Write å®Ÿè¡Œå‰"
      input:
        - "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ"
        - "å¤‰æ›´å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«"
      process:
        hooks:
          - "consent-guard.sh: consent ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª"
        subagents: []
        skills:
          - "consent-process: [ç†è§£ç¢ºèª] å‡ºåŠ›"
        claude_md: "[ç†è§£ç¢ºèª] what, why, how, scope, exclusions, risks"
      output:
        - "[ç†è§£ç¢ºèª] ãƒ–ãƒ­ãƒƒã‚¯"
        - "consent ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ï¼ˆOK ã®å ´åˆï¼‰"
        - "Edit/Write å®Ÿè¡Œè¨±å¯"
      references:
        - ".claude/hooks/consent-guard.sh"
        - ".claude/skills/consent-process/"
        - "CLAUDE.md#ç†è§£ç¢ºèª"

    - id: critique_process
      name: "CRITIQUE"
      why: |
        ã€Œå®Œäº†ã€ã®è‡ªå·±åˆ¤æ–­ã‚’ç¦æ­¢ã—ã€critic SubAgent ã«ã‚ˆã‚‹å®¢è¦³çš„æ¤œè¨¼ã§å ±é…¬è©æ¬ºã‚’é˜²æ­¢ã€‚
        done_criteria ã®é”æˆã‚’è¨¼æ‹ ä»˜ãã§ç¢ºèªã€‚
      when: "phase å®Œäº†ç”³å‘Šæ™‚"
      input:
        - "phase.done_criteria"
        - "test_command å®Ÿè¡Œçµæœ"
        - "å¤‰æ›´å†…å®¹"
      process:
        hooks:
          - "critic-guard.sh: critic å®Ÿè¡Œãƒã‚§ãƒƒã‚¯"
        subagents:
          - "critic: done_criteria æ¤œè¨¼"
        skills: []
        claude_md: "CRITIQUE ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‚ç…§"
      output:
        - "critic åˆ¤å®šï¼ˆPASS/FAILï¼‰"
        - "æ ¹æ‹ ï¼ˆevidenceï¼‰"
        - "ä¿®æ­£æŒ‡ç¤ºï¼ˆFAIL ã®å ´åˆï¼‰"
      references:
        - ".claude/hooks/critic-guard.sh"
        - ".claude/subagents/critic/"
        - ".claude/rules/frameworks/done-criteria-validation.md"
        - "CLAUDE.md#CRITIQUE"

# ==============================================================================
# å¤‰æ›´å±¥æ­´
# ==============================================================================
changelog:
  - date: "2025-12-22 13:11:53"
    action: "auto-generated"
    description: "playbook å®Œäº†æ™‚ã«è‡ªå‹•ç”Ÿæˆ"
